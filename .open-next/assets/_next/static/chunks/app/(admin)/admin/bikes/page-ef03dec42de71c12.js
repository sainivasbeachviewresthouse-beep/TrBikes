(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[206],{5469:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(18097),l=a.n(r),s=a(15106),n=a(19178),i=a(51082);let c=s.forwardRef((e,t)=>{let{bsPrefix:a,fluid:r=!1,as:s="div",className:c,...o}=e,d=(0,n.oU)(a,"container");return(0,i.jsx)(s,{ref:t,...o,className:l()(c,r?"".concat(d).concat("string"==typeof r?"-".concat(r):"-fluid"):d)})});c.displayName="Container";let o=c},19065:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(15106);function l(e){let t=function(e){let t=(0,r.useRef)(e);return t.current=e,t}(e);(0,r.useEffect)(()=>()=>t.current(),[])}},35473:(e,t,a)=>{"use strict";function r(e){return[...e].sort((e,t)=>e.availability===t.availability?new Date(e.created_at||"").getTime()-new Date(t.created_at||"").getTime():e.availability?-1:1)}a.d(t,{G:()=>l});let l=(0,a(16414).v)(e=>({bikes:[],setBikes:t=>e({bikes:r(t)}),addBike:t=>e(e=>({bikes:r([t,...e.bikes])})),updateBike:t=>e(e=>({bikes:r(e.bikes.map(e=>e.id===t.id?t:e))})),removeBike:t=>e(e=>({bikes:e.bikes.filter(e=>e.id!==t)}))}))},43163:(e,t,a)=>{Promise.resolve().then(a.bind(a,69477))},69477:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Y});var r,l=a(51082),s=a(15106),n=a(5469),i=a(67826),c=a(96744),o=a(81135),d=a(18097),u=a.n(d),m=a(20790),h=a(87178),p=a(29611),x=a(377);function f(e){if((!r&&0!==r||e)&&h.A){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),r=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return r}var b=a(94167),g=a(73362),y=a(19065),j=a(54085),v=a(18971),N=a(32268),A=a(76296),w=a(19178);let k=s.forwardRef((e,t)=>{let{className:a,bsPrefix:r,as:s="div",...n}=e;return r=(0,w.oU)(r,"modal-body"),(0,l.jsx)(s,{ref:t,className:u()(a,r),...n})});k.displayName="ModalBody";var _=a(84806);let C=s.forwardRef((e,t)=>{let{bsPrefix:a,className:r,contentClassName:s,centered:n,size:i,fullscreen:c,children:o,scrollable:d,...m}=e;a=(0,w.oU)(a,"modal");let h="".concat(a,"-dialog"),p="string"==typeof c?"".concat(a,"-fullscreen-").concat(c):"".concat(a,"-fullscreen");return(0,l.jsx)("div",{...m,ref:t,className:u()(h,r,i&&"".concat(a,"-").concat(i),n&&"".concat(h,"-centered"),d&&"".concat(h,"-scrollable"),c&&p),children:(0,l.jsx)("div",{className:u()("".concat(a,"-content"),s),children:o})})});C.displayName="ModalDialog";let I=s.forwardRef((e,t)=>{let{className:a,bsPrefix:r,as:s="div",...n}=e;return r=(0,w.oU)(r,"modal-footer"),(0,l.jsx)(s,{ref:t,className:u()(a,r),...n})});I.displayName="ModalFooter";var D=a(76080);let R=s.forwardRef((e,t)=>{let{bsPrefix:a,className:r,closeLabel:s="Close",closeButton:n=!1,...i}=e;return a=(0,w.oU)(a,"modal-header"),(0,l.jsx)(D.A,{ref:t,...i,className:u()(r,a),closeLabel:s,closeButton:n})});R.displayName="ModalHeader";let S=(0,a(84792).A)("h4"),T=s.forwardRef((e,t)=>{let{className:a,bsPrefix:r,as:s=S,...n}=e;return r=(0,w.oU)(r,"modal-title"),(0,l.jsx)(s,{ref:t,className:u()(a,r),...n})});function E(e){return(0,l.jsx)(A.A,{...e,timeout:null})}function U(e){return(0,l.jsx)(A.A,{...e,timeout:null})}T.displayName="ModalTitle";let B=s.forwardRef((e,t)=>{let{bsPrefix:a,className:r,style:n,dialogClassName:i,contentClassName:c,children:o,dialogAs:d=C,"data-bs-theme":A,"aria-labelledby":k,"aria-describedby":I,"aria-label":D,show:R=!1,animation:S=!0,backdrop:T=!0,keyboard:B=!0,onEscapeKeyDown:F,onShow:z,onHide:O,container:M,autoFocus:L=!0,enforceFocus:P=!0,restoreFocus:H=!0,restoreFocusOptions:G,onEntered:J,onExit:V,onExiting:W,onEnter:Z,onEntering:q,onExited:K,backdropClassName:Y,manager:Q,...X}=e,[$,ee]=(0,s.useState)({}),[et,ea]=(0,s.useState)(!1),er=(0,s.useRef)(!1),el=(0,s.useRef)(!1),es=(0,s.useRef)(null),[en,ei]=(0,s.useState)(null),ec=(0,g.A)(t,ei),eo=(0,b.A)(O),ed=(0,w.Wz)();a=(0,w.oU)(a,"modal");let eu=(0,s.useMemo)(()=>({onHide:eo}),[eo]);function em(){return Q||(0,N.R)({isRTL:ed})}function eh(e){if(!h.A)return;let t=em().getScrollbarWidth()>0,a=e.scrollHeight>(0,p.A)(e).documentElement.clientHeight;ee({paddingRight:t&&!a?f():void 0,paddingLeft:!t&&a?f():void 0})}let ep=(0,b.A)(()=>{en&&eh(en.dialog)});(0,y.A)(()=>{(0,x.A)(window,"resize",ep),null==es.current||es.current()});let ex=()=>{er.current=!0},ef=e=>{er.current&&en&&e.target===en.dialog&&(el.current=!0),er.current=!1},eb=()=>{ea(!0),es.current=(0,j.A)(en.dialog,()=>{ea(!1)})},eg=e=>{if("static"===T)return void(e=>{e.target===e.currentTarget&&eb()})(e);if(el.current||e.target!==e.currentTarget){el.current=!1;return}null==O||O()},ey=(0,s.useCallback)(e=>(0,l.jsx)("div",{...e,className:u()("".concat(a,"-backdrop"),Y,!S&&"show")}),[S,Y,a]),ej={...n,...$};return ej.display="block",(0,l.jsx)(_.A.Provider,{value:eu,children:(0,l.jsx)(v.A,{show:R,ref:ec,backdrop:T,container:M,keyboard:!0,autoFocus:L,enforceFocus:P,restoreFocus:H,restoreFocusOptions:G,onEscapeKeyDown:e=>{B?null==F||F(e):(e.preventDefault(),"static"===T&&eb())},onShow:z,onHide:O,onEnter:(e,t)=>{e&&eh(e),null==Z||Z(e,t)},onEntering:(e,t)=>{null==q||q(e,t),(0,m.Ay)(window,"resize",ep)},onEntered:J,onExit:e=>{null==es.current||es.current(),null==V||V(e)},onExiting:W,onExited:e=>{e&&(e.style.display=""),null==K||K(e),(0,x.A)(window,"resize",ep)},manager:em(),transition:S?E:void 0,backdropTransition:S?U:void 0,renderBackdrop:ey,renderDialog:e=>(0,l.jsx)("div",{role:"dialog",...e,style:ej,className:u()(r,a,et&&"".concat(a,"-static"),!S&&"show"),onClick:T?eg:void 0,onMouseUp:ef,"data-bs-theme":A,"aria-label":D,"aria-labelledby":k,"aria-describedby":I,children:(0,l.jsx)(d,{...X,onMouseDown:ex,className:i,contentClassName:c,children:o})})})})});B.displayName="Modal";let F=Object.assign(B,{Body:k,Header:R,Title:T,Footer:I,Dialog:C,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150});var z=a(27503),O=a(78521),M=a(35473),L=a(40366);function P(e){let{bike:t,onEdit:a,onDelete:r,onToggleActive:s}=e;return(0,l.jsxs)(L.A,{className:"shadow-sm h-100",children:[(0,l.jsx)(L.A.Img,{variant:"top",src:t.image_url||"/bike-placeholder.jpg",alt:t.name,style:{height:"180px",objectFit:"cover",borderBottom:"1px solid #eee"}}),(0,l.jsxs)(L.A.Body,{children:[(0,l.jsx)(L.A.Title,{className:"text-truncate",children:t.name}),(0,l.jsxs)(L.A.Text,{className:"text-muted text-truncate",children:[t.category," • ",t.color]}),(0,l.jsxs)(L.A.Text,{className:"fw-bold mb-2",children:["₹",t.rent_per_hour,"/hour"]}),(0,l.jsx)(z.A.Check,{type:"switch",id:"toggle-".concat(t.id),label:t.availability?"Active":"Inactive",checked:t.availability||!1,onChange:()=>s(t.id,!t.availability),className:"mb-3"}),(0,l.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,l.jsx)(i.A,{variant:"warning",size:"sm",onClick:()=>a(t),children:"Edit"}),(0,l.jsx)(i.A,{variant:"danger",size:"sm",onClick:()=>r(t.id),children:"Delete"})]})]})]})}var H=a(93956);let G=s.createContext(null);G.displayName="InputGroupContext";let J=s.forwardRef((e,t)=>{let{className:a,bsPrefix:r,as:s="span",...n}=e;return r=(0,w.oU)(r,"input-group-text"),(0,l.jsx)(s,{ref:t,className:u()(a,r),...n})});J.displayName="InputGroupText";let V=s.forwardRef((e,t)=>{let{bsPrefix:a,size:r,hasValidation:n,className:i,as:c="div",...o}=e;a=(0,w.oU)(a,"input-group");let d=(0,s.useMemo)(()=>({}),[]);return(0,l.jsx)(G.Provider,{value:d,children:(0,l.jsx)(c,{ref:t,...o,className:u()(i,a,r&&"".concat(a,"-").concat(r),n&&"has-validation")})})});V.displayName="InputGroup";let W=Object.assign(V,{Text:J,Radio:e=>(0,l.jsx)(J,{children:(0,l.jsx)(H.A,{type:"radio",...e})}),Checkbox:e=>(0,l.jsx)(J,{children:(0,l.jsx)(H.A,{type:"checkbox",...e})})});var Z=a(96824);function q(e){let{value:t,onChange:a}=e,[r,n]=(0,s.useState)(t||""),[c,o]=(0,s.useState)(null),[d,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(!1),[p,x]=(0,s.useState)(""),[f,b]=(0,s.useState)([]),[g,y]=(0,s.useState)(!1);(0,s.useEffect)(()=>n(t),[t]),(0,s.useEffect)(()=>{if(c&&r.startsWith("blob:"))return()=>URL.revokeObjectURL(r)},[c,r]);let j=e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];if(r){if(r.size>1048576)return alert("File must be below 1 MB!");o(r),a(r),n(URL.createObjectURL(r))}},v=async()=>{if(p.trim()){y(!0);try{let e=await fetch("".concat("/api/pexels-search","?query=").concat(encodeURIComponent(p))),t=await e.json();b(t.photos||[])}catch(e){alert("Failed to fetch from Pexels")}finally{y(!1)}}};return(0,l.jsxs)("div",{children:[r&&(0,l.jsxs)("div",{className:"mb-3 text-center",children:[(0,l.jsx)(Z.default,{src:r,alt:"Preview",width:300,height:150,style:{maxWidth:"100%",height:"150px",objectFit:"cover",borderRadius:"6px"}}),(0,l.jsx)(i.A,{variant:"danger",size:"sm",onClick:()=>{n(""),o(null),a(null)},className:"ms-2",children:"Clear"})]}),(0,l.jsxs)("div",{onDragOver:e=>{e.preventDefault(),u(!0)},onDragLeave:()=>u(!1),onDrop:e=>{e.preventDefault(),u(!1);let t=e.dataTransfer.files[0];if(t){if(t.size>1048576)return alert("File must be below 1 MB!");o(t),a(t),n(URL.createObjectURL(t))}},className:"p-3 border rounded text-center ".concat(d?"bg-light border-primary":"border-secondary"),style:{cursor:"pointer"},children:[(0,l.jsx)(z.A.Label,{className:"d-block mb-2",children:c?"File Selected: ".concat(c.name):"Drag & Drop Image Here"}),(0,l.jsxs)("div",{className:"d-flex justify-content-center gap-2 flex-wrap",children:[(0,l.jsx)("input",{id:"uploadInput",type:"file",accept:"image/*",style:{display:"none"},onChange:j}),(0,l.jsx)(i.A,{variant:"outline-primary",size:"sm",onClick:()=>{var e;return null==(e=document.getElementById("uploadInput"))?void 0:e.click()},children:"\uD83D\uDCC1 Upload from Folder"}),(0,l.jsx)("input",{id:"cameraInput",type:"file",accept:"image/*",capture:"environment",style:{display:"none"},onChange:j}),(0,l.jsx)(i.A,{variant:"outline-success",size:"sm",onClick:()=>{var e;return null==(e=document.getElementById("cameraInput"))?void 0:e.click()},children:"\uD83D\uDCF8 Take Photo"})]}),(0,l.jsx)("small",{className:"text-muted d-block mt-2",children:"JPG/PNG under 1 MB • or use camera"})]}),(0,l.jsx)("div",{className:"d-flex justify-content-start mt-3",children:(0,l.jsx)(i.A,{variant:"outline-secondary",size:"sm",onClick:()=>h(!0),children:"\uD83D\uDDBC️ Choose from Pexels"})}),(0,l.jsxs)(F,{show:m,onHide:()=>h(!1),centered:!0,size:"lg",children:[(0,l.jsx)(F.Header,{closeButton:!0,children:(0,l.jsx)(F.Title,{children:"Select from Pexels"})}),(0,l.jsxs)(F.Body,{children:[(0,l.jsxs)(W,{className:"mb-3",children:[(0,l.jsx)(z.A.Control,{placeholder:"Search bikes, motorcycles, etc.",value:p,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"===e.key&&v()}}),(0,l.jsx)(i.A,{onClick:v,disabled:g,children:g?"Searching...":"Search"})]}),g?(0,l.jsx)("p",{className:"text-center",children:"Loading..."}):f.length>0?(0,l.jsx)("div",{className:"row g-3",children:f.map(e=>(0,l.jsx)("div",{className:"col-6 col-md-3",style:{cursor:"pointer"},onClick:()=>{var t;a(t=e.src.medium),n(t),o(null),h(!1)},children:(0,l.jsx)(Z.default,{src:e.src.medium,alt:e.photographer,width:200,height:100,style:{width:"100%",height:"100px",objectFit:"cover",borderRadius:"6px"}})},e.id))}):(0,l.jsx)("p",{className:"text-muted text-center",children:"Try searching for “bike” or “motorcycle”"})]})]})]})}let K={title:"",registration_no:"",category:"",paint_color:"",rental_cost_per_hour:"",image_url:""};function Y(){let[e,t]=(0,s.useState)(!1),[a,r]=(0,s.useState)(""),[d,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(null),[p,x]=(0,s.useState)(null),[f,b]=(0,s.useState)(K),[g,y]=(0,s.useState)(!1),{bikes:j,setBikes:v,addBike:N,updateBike:A,removeBike:w}=(0,M.G)(),k=localStorage.getItem("adminToken"),_=()=>{u(!1),h(null),x(null),b(K),y(!1)},C=(0,s.useCallback)(async()=>{t(!0),r("");try{let e=await fetch("/api/bikes"),t=await e.json();t.success?v(t.data):r(t.message)}catch(e){r("Failed to retrieve vehicles")}finally{t(!1)}},[v]);(0,s.useEffect)(()=>{(async()=>{try{await C()}catch(e){console.error(e)}})();let e=O.m.channel("bikes-changes").on("postgres_changes",{event:"*",schema:"public",table:"bikes"},e=>{"INSERT"===e.eventType?N(e.new):"UPDATE"===e.eventType?A(e.new):"DELETE"===e.eventType&&w(e.old.id)}).subscribe();return()=>{O.m.removeChannel(e)}},[C,N,A,w]);let I=e=>{let{name:t,value:a}=e.target;b(e=>({...e,[t]:a}))},D=async e=>{if(e.preventDefault(),t(!0),r(""),!m&&!p&&!f.image_url){r("Please select or upload an image for this vehicle."),y(!0),t(!1);return}let a=new FormData;Object.entries(f).forEach(e=>{let[t,r]=e,l=t;"title"===t?l="name":"paint_color"===t?l="color":"rental_cost_per_hour"===t&&(l="rent_per_hour"),("image_url"!==l||r)&&a.append(l,r)}),p&&a.append("image_file",p);let l=m?"/api/admin/bikes/".concat(m.id):"/api/admin/bikes",s=m?"PATCH":"POST";try{let e=await fetch(l,{method:s,headers:{Authorization:"Bearer ".concat(k)},body:a}),t=await e.json();t.success?_():r(t.message)}catch(e){r("Failed to store vehicle data")}finally{t(!1)}},R=async e=>{if(confirm("Are you sure you want to remove this vehicle?"))try{let t=await fetch("/api/admin/bikes/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(k)}}),a=await t.json();a.success||r(a.message)}catch(e){r("Failed to remove vehicle")}},S=e=>{h(e),b({title:e.name,registration_no:e.registration_no,category:e.category,paint_color:e.color,rental_cost_per_hour:e.rent_per_hour.toString(),image_url:e.image_url||""}),u(!0),y(!1)},T=async(e,t)=>{try{let a=await fetch("/api/admin/bikes/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(k)},body:JSON.stringify({availability:t})}),l=await a.json();l.success||r(l.message)}catch(e){r("Failed to update operational status")}};return(0,l.jsxs)(n.A,{className:"py-4",children:[(0,l.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,l.jsx)("h2",{className:"mb-0",children:"Control Vehicles"}),(0,l.jsx)(i.A,{onClick:()=>{h(null),b(K),u(!0),y(!1)},children:"Insert New Vehicle"})]}),a&&(0,l.jsx)(c.A,{variant:"danger",children:a}),e&&0===j.length?(0,l.jsx)("div",{className:"text-center my-5",children:(0,l.jsx)(o.A,{animation:"border"})}):j.length>0?(0,l.jsx)("div",{className:"row g-4",children:j.map(e=>(0,l.jsx)("div",{className:"col-12 col-sm-6 col-md-4 col-lg-3",children:(0,l.jsx)(P,{bike:e,onEdit:S,onDelete:R,onToggleActive:T})},e.id))}):(0,l.jsx)("p",{className:"text-muted text-center mt-4",children:"No vehicles found."}),(0,l.jsxs)(F,{show:d,onHide:_,centered:!0,children:[(0,l.jsx)(F.Header,{closeButton:!0,children:(0,l.jsx)(F.Title,{children:m?"Modify Vehicle":"Insert New Vehicle"})}),(0,l.jsx)(F.Body,{children:(0,l.jsxs)(z.A,{onSubmit:D,children:[["title","registration_no","category","paint_color"].map(e=>(0,l.jsxs)(z.A.Group,{className:"mb-2",children:[(0,l.jsx)(z.A.Label,{children:e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}),(0,l.jsx)(z.A.Control,{name:e,value:f[e],onChange:I,required:"paint_color"!==e})]},e)),(0,l.jsxs)(z.A.Group,{className:"mb-2",children:[(0,l.jsx)(z.A.Label,{children:"Rental Cost per Hour"}),(0,l.jsx)(z.A.Control,{type:"number",name:"rental_cost_per_hour",value:f.rental_cost_per_hour,onChange:I,required:!0})]}),(0,l.jsxs)(z.A.Group,{className:"mb-3",children:[(0,l.jsxs)(z.A.Label,{children:["Vehicle Picture ",(0,l.jsx)("span",{className:"text-danger",children:"*"})]}),(0,l.jsx)("div",{style:{border:g?"2px solid red":"none",borderRadius:"8px",padding:g?"4px":"0"},children:(0,l.jsx)(q,{value:f.image_url,onChange:e=>{y(!1),e instanceof File?(x(e),b(e=>({...e,image_url:""}))):"string"==typeof e?(x(null),b(t=>({...t,image_url:e}))):(x(null),b(e=>({...e,image_url:""})))}})}),g&&(0,l.jsx)("small",{className:"text-danger",children:"Image is required for new vehicles."})]}),(0,l.jsx)(i.A,{type:"submit",className:"mt-3 w-100",disabled:e,children:e?(0,l.jsx)(o.A,{animation:"border",size:"sm"}):m?"Update Vehicle":"Insert Vehicle"})]})})]})]})}},78521:(e,t,a)=>{"use strict";a.d(t,{m:()=>r});let r=(0,a(14766).UU)("https://queorpstgdhpjarndcyp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF1ZW9ycHN0Z2RocGphcm5kY3lwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2MDc5NzEsImV4cCI6MjA3NjE4Mzk3MX0.KmsCQcRycZo-YPys5D78aRUcKS0nYIFhDQLI2bSS1Qw")},81135:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(18097),l=a.n(r),s=a(15106),n=a(19178),i=a(51082);let c=s.forwardRef((e,t)=>{let{bsPrefix:a,variant:r,animation:s="border",size:c,as:o="div",className:d,...u}=e;a=(0,n.oU)(a,"spinner");let m="".concat(a,"-").concat(s);return(0,i.jsx)(o,{ref:t,...u,className:l()(d,m,c&&"".concat(m,"-").concat(c),r&&"text-".concat(r))})});c.displayName="Spinner";let o=c}},e=>{e.O(0,[88,233,824,908,365,294,413,106,358],()=>e(e.s=43163)),_N_E=e.O()}]);